)
}
par(mfrow = c(1, 1))
data <- read.csv("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/prostat_ca_veri_seti_duzeltilmis_v2.csv", header=T)
str(data)
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
head(data)
str(data)
summary(data)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
bcr_table <- table(data$Treatment, data$BCR)
cat("Frequency Table (Counts):\n")
print(bcr_table)
bcr_test <- chisq.test(bcr_table)
cat("\nChi-squared Test Results:\n")
print(bcr_test)
cat("\nBCR Rate (%) within each Treatment Group:\n")
round(prop.table(bcr_table, margin = 1) * 100, 1)
bcr_table <- table(data$Treatment, data$BCR)
cat("Frequency Table (Counts):\n")
print(bcr_table)
bcr_test <- chisq.test(bcr_table)
cat("\nChi-squared Test Results:\n")
print(bcr_test)
cat("\nBCR Rate (%) within each Treatment Group:\n")
round(prop.table(bcr_table, margin = 1) * 100, 1)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("green", "red"), # False = Green, True = Red
legend.text = c("No Recurrence (False)", "Recurrence (True)"),
args.legend = list(x = "topleft", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
View(ks_a)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"), # False = Green, True = Red
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
bcr_prop_table * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("green", "red"), # False = Green, True = Red
legend.text = c("No Recurrence (False)", "Recurrence (True)"),
args.legend = list(x = "topleft", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence (False)", "Recurrence (True)"),
args.legend = list(x = "topleft", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(x = "topleft", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(x = "topright", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-0.35, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
beside = TRUE
ylim = c(0, 100),
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-0.35, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
beside = TRUE,
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-0.1, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
beside = TRUE,
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
barplot(
t(bcr_prop_table) * 100, # 행과 열을 바꿔 BCR 상태(False/True)를 스택으로 표시
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(x = "topright", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(x = "topright", title = "BCR Status"),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-0.35, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-2, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-0.8, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",  # 오른쪽 상단으로 지정
inset = c(-0.7, 0), # x축 방향으로 음수 값을 주어 오른쪽 마진 공간으로 이동
xpd = TRUE # 그래프 영역 밖에도 그림을 그릴 수 있도록 허용
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.7, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.5, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.3, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot2
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.2, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(10, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.5, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-
therapy", "Hormone Therapy,", "RT + ADT")
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.5, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("Radical Prostatectomy", "Radio-therapy", "Hormone Therapy,", "RT + ADT"),
las = 2,
)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.5, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("RP", "RT", "ADT", "RT + ADT")
)
survival_prop_table <- prop.table(survival_table, margin = 1)
survival_table <- table(data$Treatment, data$Survival)
cat("Frequency Table (Counts):\n")
print(survival_table)
survival_test <- chisq.test(survival_table)
cat("\nChi-squared Test Results:\n")
print(survival_test)
cat("\nSurvival Rate (%) within each Treatment Group (Survival = Alive):\n")
round(prop.table(survival_table, margin = 1) * 100, 1)
survival_prop_table <- prop.table(survival_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(survival_prop_table) * 100,
main = "Survival Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("Alive", "Deceased"),
args.legend = list(
title = "Risk Class",
x = "topright",
inset = c(-0.5, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("RP", "RT", "ADT", "RT + ADT")
)
data$Delta_PSA <- data$PSA_before - data$PSA_after
anova_result <- aov(Delta_PSA ~ Treatment, data = data)
summary(anova_result)
TukeyHSD(anova_result)
boxplot(Delta_PSA ~ Treatment,
data = data,
main = "Delta PSA Distribution by Treatment Type",
xlab = "Treatment Type",
ylab = "Delta PSA (PSA_before - PSA_after)",
col = rainbow(4),
names = c("Radical Prostatectomy (1)", "RT (2)", "ADT (3)", "RT + ADT (4)"))
# 2. (선택적) 평균을 상자에 추가 (점선으로 표시된 부분)
means <- tapply(data$Delta_PSA, data$Treatment, mean, na.rm=TRUE)
points(means, pch = 8, col = "black", cex = 1.5)
par(mar = c(5, 4, 4, 2) + 0.1)
boxplot(Delta_PSA ~ Treatment,
data = data,
main = "Delta PSA Distribution by Treatment Type",
xlab = "Treatment Type",
ylab = "Delta PSA (PSA_before - PSA_after)",
col = rainbow(4),
names = c("RP", "RT", "ADT", "RT + ADT")
means <- tapply(data$Delta_PSA, data$Treatment, mean, na.rm=TRUE)
par(mar = c(5, 4, 4, 2) + 0.1)
boxplot(Delta_PSA ~ Treatment,
data = data,
main = "Delta PSA Distribution by Treatment Type",
xlab = "Treatment Type",
ylab = "Delta PSA (PSA_before - PSA_after)",
col = rainbow(4),
names = c("RP", "RT", "ADT", "RT + ADT")
)
means <- tapply(data$Delta_PSA, data$Treatment, mean, na.rm=TRUE)
points(means, pch = 8, col = "black", cex = 1.5)
par(mar = c(5, 4, 4, 2) + 0.1)
boxplot(Delta_PSA ~ Treatment,
data = data,
main = "Delta PSA Distribution by Treatment Type",
xlab = "Treatment Type",
ylab = "Delta PSA (PSA at diagnosis - PSA after treatment)",
col = rainbow(4),
names = c("RP", "RT", "ADT", "RT + ADT")
)
means <- tapply(data$Delta_PSA, data$Treatment, mean, na.rm=TRUE)
points(means, pch = 8, col = "black", cex = 1.5)
bcr_table <- table(data$Treatment, data$BCR)
cat("Frequency Table (Counts):\n")
print(bcr_table)
bcr_test <- chisq.test(bcr_table)
cat("\nChi-squared Test Results:\n")
print(bcr_test)
cat("\nBCR Rate (%) within each Treatment Group:\n")
round(prop.table(bcr_table, margin = 1) * 100, 1)
bcr_prop_table <- prop.table(bcr_table, margin = 1)
par(mar = c(5, 4, 4, 10) + 0.1)
barplot(
t(bcr_prop_table) * 100,
main = "Biochemical Recurrence (BCR) Rate by Treatment Type",
xlab = "Treatment Type",
ylab = "Percentage (%)",
col = c("blue", "red"),
legend.text = c("No Recurrence", "Recurrence"),
args.legend = list(
title = "Class",
x = "topright",
inset = c(-0.5, 0),
xpd = TRUE,
cex = 0.8
),
ylim = c(0, 100),
names.arg = c("RP", "RT", "ADT", "RT + ADT")
)
par(mar = c(5, 4, 4, 2) + 0.1)
boxplot(Delta_PSA ~ Treatment,
data = data,
main = "Delta PSA Distribution by Treatment Type",
xlab = "Treatment Type",
ylab = "Delta PSA (PSA at diagnosis - PSA after treatment)",
col = rainbow(4),
names = c("RP", "RT", "ADT", "RT + ADT")
)
means <- tapply(data$Delta_PSA, data$Treatment, mean, na.rm=TRUE)
points(means, pch = 8, col = "black", cex = 1.5)
