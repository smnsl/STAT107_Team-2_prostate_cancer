sessionInfo()
#######################################################
#######################################################
remove_na <- function(df) { ## Automatize the removal of missing observations.
n_obs <- nrow(df)
missing <- rep(FALSE, n_obs)
for (obs_ind in 1:n_obs) {
obs <- df[obs_ind, ]
n_missing <- sum(is.na(obs))
if(n_missing > 0) {
missing[obs_ind] <- TRUE
}
}
df_red <- df[!missing, ]
return(df_red)
}
#######################################################
#######################################################
to_factors <- function(df) { ## Turn all character variables to factors.
n_vars <- ncol(df)
for (var_ind in 1:n_vars) {
var <- df[, var_ind]
if (class(var) == "character") {
df[, var_ind] <- factor(var)
}
}
return(df)
}
source("http://www.openintro.org/stat/data/cdc.R")
remove_na(cdc)
to_factors(cdc)
cdc_clean <- cdc[1000,]
cdc_clean
cdc_clean <- cdc[1:1000,]
cdc_clean
color_by_gender <- ifelse(cdc_clean$gender == "f", "forestgreen", "darkred")
pointstyle_by_gender <- ifelse(cdc_clean$gender == "f", 17, 8)
names(cdc_clean) [5] <- "Height (in.)"
names(cdc_clean) [6] <- "Weight (lbs)"
names(cdc_clean) [7] <- "Desired Weight (lbs)"
names(cdc_clean) [8] <- "Age (Years)"
names(cdc_clean) [9] <- "Gender"
variable_name_D <- colnames(cdc_clean)[5]
boxplot(cdc_clean[[variable_name_D]] ~ cdc_clean$Gender,
main = variable_name_D,
ylab = variable_name_D,
xlab = "Gender")
boxplot(cdc_clean[["Height (in.)"]] ~ cdc_clean$Gender,
main = variable_name_D,
ylab = variable_name_D,
xlab = "Gender")
variable_name <- colnames(cdc_clean)[5]
boxplot(cdc_clean[[variable_name]] ~ cdc_clean$Gender,
main = "boxplot of the variable Height (in.)",
ylab = variable_name,
xlab = "Gender")
numeric_vars <- c(5, 6, 7, 8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
numeric_vars <- c(5, 6, 7, 8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
par(mfrow = c(1, 1))
numeric_vars <- c(5:8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
par(mfrow = c(1, 1))
data <- read.csv("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/prostat_ca_veri_seti_duzeltilmis_v2.csv", header=T)
str(data)
anova_result <- aov(PSA_before ~ Treatment, data = data)
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
anova_result <- aov(PSA_before ~ Treatment, data = data)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
anova_result <- aov(PSA_before ~ Treatment, data = data)
summary(anova_result)
TukeyHSD(anova_result)
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
tinytex::tlmgr("option repository https://mirror.ctan.org/systems/texlive/tlnet")
tinytex::tlmgr_update()
tinytex::tlmgr_install("colortbl")
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
tinytex::uninstall_tinytex()
tinytex::install_tinytex(repository = "https://mirror.ctan.org/systems/texlive/tlnet")
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
source("00_requirements.R")
clinical <- "Clinical cT-Stage determined by pre-treatment examinations (cT1c < cT2a < cT2b < cT2c < cT3a < cT3b for increasing extent of tumor invasion)"
biopsy <- "Biopsy Gleason Score (3+3 < 3+4 < 4+3 < 3+5 < 4+4 < 4+5 < 5+4 < 5+5, higher score indicates higher aggressiveness)"
colA <- c("Hasta_ID",
"Yas",
"Tani_Tarihi",
"PSA_Tani",
"Klinik_Evre",
"Biyopsi_Gleason",
"Risk_Grubu")
colB <- c("Patient ID",
"Age",
"Diagnosis Date",
"Serum Prostate-Specific Antigen (PSA) level at diagnosis (ng/mL)",
clinical,
biopsy,
"Risk Group Classification (1 for Low, 2 for Intermediate, 3 forHigh)"
)
colC <- c("Categorical",
"Discrete",
"Date",
"Continuous",
"Ordinal/Categorical",
"Ordinal/Categorical",
"Ordinal/Categorical")
table_initial <- data.frame(
Variable_Name = colA,
English_Translation = colB,
Type_of_Data = colC
)
table_initial %>%
kable(caption = "Initial Diagnosis Variables", booktabs = TRUE) %>%
kable_styling(latex_options = "hold_position") %>%
column_spec(2, width = "6cm")
neutro <- "Neutrophil-to-Lymphocyte Ratio. A prognostic indicator for systemic inflammation and cancer aggressiveness."
cally <- "CALLY Index. A composite index, likely related to inflammation or blood components."
comorbidity <- "Comorbidity Score indicating the severity of other co-existing chronic diseases ( 0 (No comorbidities) < ... < 5 (Severe comorbidities))"
colA <- c("Albumin",
"Lenfosit",
"CRP",
"NLR",
"CALLY_Index",
"Komorbidite_Skor")
colB <- c("ASerum albumin level (g/dL). Indicator of nutritional status and systemic health",
"Lymphocyte (Immune system component) Count",
"C-Reactive Protein (mg/L). Indicator of inflammation",
neutro,
cally,
comorbidity
)
colC <- c("Continuous",
"Discrete",
"Continuous",
"Continuous",
"Continuous",
"Ordinal/Categorical")
table_risk <- data.frame(
Variable = colA,
In_English = colB,
Type_of_Data = colC
)
table_risk %>%
kable(caption = "Risk Factors", booktabs = TRUE) %>%
kable_styling(latex_options = "hold_position") %>%
column_spec(2, width = "6cm")
main <- "Main Treatment Type received (1 for Radical Prostatectomy, 2 for
Radiotherapy/RT, 3 for Hormone Therapy, 4 for Combination of Radiotherapy and Hormone Therapy)"
colA <- c("Tedavi_Tipi",
"Tedavi_Tarihi",
"RT_Dozu",
"ADT_Tipi",
"ADT_Suresi"
)
colB <- c(main,
"Treatment Date",
"Total Radiation Dose (in Gy), if radiotherapy was performed",
"Androgen Deprivation Therapy (ADT, hormone therapy) Type used",
"ADT(hormone therapy) Duration"
)
colC <- c("Categorical",
"Date",
"Continuous",
"Categorical",
"Continuous"
)
table_info <- data.frame(
Variable = colA,
In_English = colB,
Type_of_Data = colC
)
table_info %>%
kable(caption = "Treatment Information", booktabs = TRUE) %>%
kable_styling(latex_options = "hold_position") %>%
column_spec(2, width = "5cm")
final <- "Final Tumor Pathological Stage determined after surgery on the removed tissue (pT2a < pT2b < pT2c < pT3a < pT3b < pT4, NaN indicates patient did not undergo surgery)"
sinir <- "Surgical Margin Status indicating if cancer cells were present at the edge of the removed tissue. Crucial for recurrence prediction (0: Negative, 1: Positive, NaN indicates patient did not undergo surgery)."
gleason <- "Final Gleason Score confirmed from the final excised tissue (3+3 < 3+4 < 4+3 < 3+5 < 4+4 < 4+5 < 5+4 < 5+5, higher score indicates higher aggressiveness)"
colA <- c("Patolojik_Evre",
"Cerrahi_Sinir",
"Final_Gleason"
)
colB <- c(final,
sinir,
gleason
)
colC <- c("Ordinal/Categorical",
"Binary/Categorical",
"Ordinal/Categorical"
)
table_marker <- data.frame(
Variable = colA,
In_English = colB,
Type_of_Data = colC
)
table_marker %>%
kable(caption = "Pathological Markers", booktabs = TRUE) %>%
kable_styling(latex_options = "hold_position") %>%
column_spec(2, width = "6cm")
lowest <- "The lowest PSA level reached after treatment (ng/mL). A lower nadir generally indicates better treatment success"
biochemical <- "Biochemical Recurrence (BCR) Status whether the PSA level rise above a recurrence threshold? (True for Recurrence occurred, False for no Recurrence occurred)"
metastas <- "Metastasis Status whether distant metastasis occur during follow-up? (0 for No, 1 for Yes)"
survival <- "Patientâ€™s Survival Status at the last follow-up (0 for Alive, 1 for Deceased)"
colA <- c("PSA_Nadir",
"PSA_Takip_3ay / 6ay / 12ay",
"BCR_Durum",
"BCR_Tarihi",
"Metastaz_Durum",
"Metastaz_Tarihi",
"Son_Durum",
"Son_Takip_Tarihi"
)
colB <- c(lowest,
"Follow-up PSA levels (ng/mL) measured at at 3/6/12 Months",
biochemical,
"Date when biochemical recurrence was confirmed",
metastas,
"Date when metastasis was confirmed",
survival,
"Date of the last recorded patient information."
)
colC <- c("Continuous",
"Continuous",
"Binary/Categorical",
"Date",
"Binary/Categorical",
"Date",
"Binary/Categorical",
"Date"
)
table_marker <- data.frame(
Variable = colA,
In_English = colB,
Type_of_Data = colC
)
table_marker %>%
kable(caption = "Follow-up \\& Outcomes", booktabs = TRUE) %>%
kable_styling(latex_options = "hold_position") %>%
column_spec(2, width = "7cm")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
sum(is.na(data$Treatment))
table(data$Treatment)
round(prop.table(table(data$Treatment)), 3)
frequencies <- table(data$Treatment)
names(frequencies) <- c("Surgery", "RT", "Hormone", "RT + Hormone")
barplot(
frequencies,
main = "Frequency of Treatment Type (Treatment)",
xlab = "Treatment Type",
ylab = "Number of Patients",
col = rainbow(4),
ylim = c(0, max(frequencies) * 1.1)
)
par(mfrow = c(1, 2))
sum(is.na(data$BCR))
table(data$BCR)
frequencies_bcr <- table(data$BCR)
names(frequencies_bcr) <- c("No Recurrence", "Recurrence")
barplot(
frequencies_bcr,
main = "Frequency of Biochemical Recurrence Status",
xlab = "Recurrence Status",
ylab = "Number of Patients",
col = c("blue", "red"),
ylim = c(0, max(frequencies_bcr) * 1.1)
)
sum(is.na(data$Survival))
table(data$Survival)
frequencies_survival <- table(data$Survival)
names(frequencies_survival) <- c("Alive", "Deceased")
barplot(
frequencies_survival,
main = "Frequency of Survival Status",
xlab = "Survival Status",
ylab = "Number of Patients",
col = c("blue", "red"),
ylim = c(0, max(frequencies_survival) * 1.1)
)
par(mfrow = c(1, 1))
PSA <- c("PSA_before", "PSA_after")
sapply(data[, PSA], function(x) sum(is.na(x)))
summary(data[, PSA])
par(mfrow = c(1, 2))
boxplot(data[["PSA_before"]],
main = "Box Plot of PSA level at diagnosis",
col = "grey")
boxplot(data[["PSA_after"]],
main = "Box Plot of PSA level after treatment",
col = "green")
source("00_requirements.R")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
data$Delta_PSA <- data$PSA_before - data$PSA_after
vars <- c("Age", "PSA_before", "CTstage", "GleasonScore_before", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore")
pairs(data[, vars])
bcr_model <- glm(BCR ~ Age + PSA_before + CTstage + GleasonScore_before + Albumin + Lymphocyte + CRP + NLR + CallyIndex + ComorbidityScore + Treatment, data = data, family = binomial, na.action = na.omit)
source("00_requirements.R")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
vars <- c("Age", "PSA_before", "CTstage", "GleasonScore_before", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore")
pairs(data[, vars])
