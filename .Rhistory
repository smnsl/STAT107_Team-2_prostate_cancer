sessionInfo()
#######################################################
#######################################################
remove_na <- function(df) { ## Automatize the removal of missing observations.
n_obs <- nrow(df)
missing <- rep(FALSE, n_obs)
for (obs_ind in 1:n_obs) {
obs <- df[obs_ind, ]
n_missing <- sum(is.na(obs))
if(n_missing > 0) {
missing[obs_ind] <- TRUE
}
}
df_red <- df[!missing, ]
return(df_red)
}
#######################################################
#######################################################
to_factors <- function(df) { ## Turn all character variables to factors.
n_vars <- ncol(df)
for (var_ind in 1:n_vars) {
var <- df[, var_ind]
if (class(var) == "character") {
df[, var_ind] <- factor(var)
}
}
return(df)
}
source("http://www.openintro.org/stat/data/cdc.R")
remove_na(cdc)
to_factors(cdc)
cdc_clean <- cdc[1000,]
cdc_clean
cdc_clean <- cdc[1:1000,]
cdc_clean
color_by_gender <- ifelse(cdc_clean$gender == "f", "forestgreen", "darkred")
pointstyle_by_gender <- ifelse(cdc_clean$gender == "f", 17, 8)
names(cdc_clean) [5] <- "Height (in.)"
names(cdc_clean) [6] <- "Weight (lbs)"
names(cdc_clean) [7] <- "Desired Weight (lbs)"
names(cdc_clean) [8] <- "Age (Years)"
names(cdc_clean) [9] <- "Gender"
variable_name_D <- colnames(cdc_clean)[5]
boxplot(cdc_clean[[variable_name_D]] ~ cdc_clean$Gender,
main = variable_name_D,
ylab = variable_name_D,
xlab = "Gender")
boxplot(cdc_clean[["Height (in.)"]] ~ cdc_clean$Gender,
main = variable_name_D,
ylab = variable_name_D,
xlab = "Gender")
variable_name <- colnames(cdc_clean)[5]
boxplot(cdc_clean[[variable_name]] ~ cdc_clean$Gender,
main = "boxplot of the variable Height (in.)",
ylab = variable_name,
xlab = "Gender")
numeric_vars <- c(5, 6, 7, 8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
numeric_vars <- c(5, 6, 7, 8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
par(mfrow = c(1, 1))
numeric_vars <- c(5:8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
par(mfrow = c(1, 1))
data <- read.csv("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/prostat_ca_veri_seti_duzeltilmis_v2.csv", header=T)
str(data)
bcr_table <- table(data$Treatment, data$BCR)
bcr_table <- table(data$Treatment, data$BCR)
bcr_table <- table(data$Treatment, data$BCR)
# Chunk 1
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
# Chunk 1
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
head(data)
str(data)
summary(data)
# Chunk 2
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
# Chunk 3
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
# Chunk 4
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
# Chunk 5
str(data)
# Chunk 6
bcr_table <- table(data$Treatment, data$BCR)
cat("Frequency Table (Counts):\n")
print(bcr_table)
bcr_test <- chisq.test(bcr_table)
cat("\nChi-squared Test Results:\n")
print(bcr_test)
cat("\nBCR Rate (%) within each Treatment Group:\n")
round(prop.table(bcr_table, margin = 1) * 100, 1)
survival_table <- table(data$Treatment, data$Survival)
cat("Frequency Table (Counts):\n")
print(survival_table)
survival_test <- chisq.test(survival_table)
cat("\nChi-squared Test Results:\n")
print(survival_test)
cat("\nSurvival Rate (%) within each Treatment Group (Survival = Alive):\n")
round(prop.table(survival_table, margin = 1) * 100, 1)
metastasis_table <- table(data$Treatment, data$Metastasis)
cat("Frequency Table (Counts):\n")
print(metastasis_table)
metastasis_test <- chisq.test(metastasis_table)
cat("\nChi-squared Test Results:\n")
print(metastasis_test)
cat("\nMetastasis Rate (%) within each Treatment Group (Metastasis = True/1):\n")
round(prop.table(metastasis_table, margin = 1) * 100, 1)
str(data)
# 1. PSA 변화량 (Delta PSA) 변수 생성
# 일반적으로 치료 효과는 PSA 감소량이므로, PSA_before - PSA_after를 사용합니다.
data$Delta_PSA <- data$PSA_before - data$PSA_after
# 2. ANOVA 실행
# aov 함수 사용: 종속변수 ~ 독립변수
anova_result <- aov(Delta_PSA ~ Treatment, data = data)
summary(anova_result)
# 3. 사후 검정 (Post-hoc Test)
# ANOVA 결과가 유의미할 경우, 어느 그룹 쌍 사이에 차이가 있는지 확인 (예: Tukey's HSD)
# TukeyHSD(anova_result)
data$Delta_PSA <- data$PSA_before - data$PSA_after
anova_result <- aov(Delta_PSA ~ Treatment, data = data)
summary(anova_result)
TukeyHSD(anova_result)
bcr_table <- table(data$Treatment, data$BCR)
cat("Frequency Table (Counts):\n")
print(bcr_table)
bcr_test <- chisq.test(bcr_table)
cat("\nChi-squared Test Results:\n")
print(bcr_test)
cat("\nBCR Rate (%) within each Treatment Group:\n")
round(prop.table(bcr_table, margin = 1) * 100, 1)
survival_table <- table(data$Treatment, data$Survival)
cat("Frequency Table (Counts):\n")
print(survival_table)
survival_test <- chisq.test(survival_table)
cat("\nChi-squared Test Results:\n")
print(survival_test)
cat("\nSurvival Rate (%) within each Treatment Group (Survival = Alive):\n")
round(prop.table(survival_table, margin = 1) * 100, 1)
survival_table <- table(data$Treatment, data$Survival)
cat("Frequency Table (Counts):\n")
print(survival_table)
survival_test <- chisq.test(survival_table)
cat("\nChi-squared Test Results:\n")
print(survival_test)
cat("\nSurvival Rate (%) within each Treatment Group (Survival = Alive):\n")
round(prop.table(survival_table, margin = 1) * 100, 1)
data$Delta_PSA <- data$PSA_before - data$PSA_after
anova_result <- aov(Delta_PSA ~ Treatment, data = data)
summary(anova_result)
TukeyHSD(anova_result)
