sessionInfo()
#######################################################
#######################################################
remove_na <- function(df) { ## Automatize the removal of missing observations.
n_obs <- nrow(df)
missing <- rep(FALSE, n_obs)
for (obs_ind in 1:n_obs) {
obs <- df[obs_ind, ]
n_missing <- sum(is.na(obs))
if(n_missing > 0) {
missing[obs_ind] <- TRUE
}
}
df_red <- df[!missing, ]
return(df_red)
}
#######################################################
#######################################################
to_factors <- function(df) { ## Turn all character variables to factors.
n_vars <- ncol(df)
for (var_ind in 1:n_vars) {
var <- df[, var_ind]
if (class(var) == "character") {
df[, var_ind] <- factor(var)
}
}
return(df)
}
source("http://www.openintro.org/stat/data/cdc.R")
remove_na(cdc)
to_factors(cdc)
cdc_clean <- cdc[1000,]
cdc_clean
cdc_clean <- cdc[1:1000,]
cdc_clean
color_by_gender <- ifelse(cdc_clean$gender == "f", "forestgreen", "darkred")
pointstyle_by_gender <- ifelse(cdc_clean$gender == "f", 17, 8)
names(cdc_clean) [5] <- "Height (in.)"
names(cdc_clean) [6] <- "Weight (lbs)"
names(cdc_clean) [7] <- "Desired Weight (lbs)"
names(cdc_clean) [8] <- "Age (Years)"
names(cdc_clean) [9] <- "Gender"
variable_name_D <- colnames(cdc_clean)[5]
boxplot(cdc_clean[[variable_name_D]] ~ cdc_clean$Gender,
main = variable_name_D,
ylab = variable_name_D,
xlab = "Gender")
boxplot(cdc_clean[["Height (in.)"]] ~ cdc_clean$Gender,
main = variable_name_D,
ylab = variable_name_D,
xlab = "Gender")
variable_name <- colnames(cdc_clean)[5]
boxplot(cdc_clean[[variable_name]] ~ cdc_clean$Gender,
main = "boxplot of the variable Height (in.)",
ylab = variable_name,
xlab = "Gender")
numeric_vars <- c(5, 6, 7, 8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
numeric_vars <- c(5, 6, 7, 8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
par(mfrow = c(1, 1))
numeric_vars <- c(5:8)
par(mfrow = c(1, 4))
for (i in numeric_vars) {
variable_name_E <- colnames(cdc_clean)[i]
boxplot(cdc_clean[[variable_name_E]] ~ cdc_clean$Gender,
main = variable_name_E,
ylab = variable_name_E,
xlab = "Gender",
)
}
par(mfrow = c(1, 1))
data <- read.csv("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/prostat_ca_veri_seti_duzeltilmis_v2.csv", header=T)
str(data)
anova_result <- aov(PSA_before ~ Treatment, data = data)
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
setwd("~/Desktop/3-2/Introduction to Statistical Computing With R/Final Project/STAT107-team2")
data <- read.csv("00_ProstateCancer_Data.csv", header=T)
anova_result <- aov(PSA_before ~ Treatment, data = data)
cols1 <- c("Tani_Tarihi", "Tedavi_Tarihi", "PSA_Takip_3ay", "PSA_Takip_6ay", "PSA_Takip_12ay", "BCR_Tarihi", "Metastaz_Tarihi", "Son_Takip_Tarihi")
data <- data[, !(names(data) %in% cols1)]
cols2 <- c("Klinik_Evre", "Biyopsi_Gleason", "Risk_Grubu", "Komorbidite_Skor", "Tedavi_Tipi", "ADT_Tipi", "Patolojik_Evre", "Cerrahi_Sinir", "Final_Gleason", "BCR_Durum", "Metastaz_Durum", "Son_Durum")
data[cols2] <- lapply(data[cols2], as.factor)
names(data) <- c("Patient ID", "Age", "PSA_before", "CTstage", "GleasonScore_before", "RiskClass", "Albumin", "Lymphocyte", "CRP", "NLR", "CallyIndex", "ComorbidityScore", "Treatment", "RadiationDose", "HormoneType", "HormonDuration" ,"TumorSize", "MarginStatus", "GleasonScore_after", "PSA_after", "BCR", "Metastasis", "Survival")
anova_result <- aov(PSA_before ~ Treatment, data = data)
summary(anova_result)
TukeyHSD(anova_result)
